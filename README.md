Heavily inspired by https://github.com/zeit/next.js/tree/canary/examples/custom-server-typescript
